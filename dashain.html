<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashain Greetings from Umesh</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Festive Warmth (Cream, Saffron, Maroon, Gold) -->
    <!-- Application Structure Plan: A single-page, vertical-scrolling greeting card. The structure breaks the original text into thematic sections: Main Greeting, Blessings, Celebration, and Tradition. This transforms a static message into a short, engaging visual journey. The user flow is a simple scroll-down, with elements subtly animating into view to create a delightful and celebratory experience. This structure was chosen to elevate the emotional impact of the greeting, making it more memorable and special than a plain text message. A new interactive section powered by the Gemini API allows users to generate personalized greetings or learn about the festival's story, adding a dynamic and educational layer. -->
    <!-- Visualization & Content Choices: Report Info: Dashain Greeting -> Goal: Convey warm, festive emotions -> Presentation Method: Themed sections with elegant typography, Unicode icons, a canvas background animation, and a Gemini API integration for dynamic text generation. -> Interaction: On-scroll fade-in animations, plus buttons to call the Gemini API for personalized content. -> Justification: This approach creates a rich, immersive experience. The Gemini integration adds a 'wow' factor and personalization, making the greeting more engaging. -> Library/Method: Vanilla JS for canvas animation, Intersection Observer for scroll effects, and Fetch API for Gemini calls. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@400;600&display=swap');
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #FFF8F0;
            color: #4A2311;
        }
        h1, h2 {
            font-family: 'Playfair Display', serif;
        }
        #background-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.6;
        }
        .scroll-animate {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .scroll-animate.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .icon-shadow {
            text-shadow: 2px 2px 8px rgba(234, 88, 12, 0.4);
        }
        .loader {
            width: 18px;
            height: 18px;
            border: 2px solid #FFF;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
            margin-right: 8px;
        }
        @keyframes rotation {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
        .pulse-animation {
            animation: pulse 2s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
        .bounce-animation {
            animation: bounce 3s ease-in-out infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }
        .floating-animation {
            animation: float 4s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% {
                transform: translateY(0px) rotate(0deg);
            }
            25% {
                transform: translateY(-8px) rotate(2deg);
            }
            50% {
                transform: translateY(-15px) rotate(-1deg);
            }
            75% {
                transform: translateY(-8px) rotate(1deg);
            }
        }
        .glow-effect {
            animation: glow 3s ease-in-out infinite alternate;
        }
        @keyframes glow {
            from {
                box-shadow: 0 0 10px rgba(234, 88, 12, 0.5);
            }
            to {
                box-shadow: 0 0 20px rgba(234, 88, 12, 0.8), 0 0 30px rgba(234, 88, 12, 0.6);
            }
        }
        .sparkle {
            position: relative;
            overflow: hidden;
        }
        .sparkle::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 215, 0, 0.3) 50%, transparent 70%);
            animation: sparkle 3s linear infinite;
            transform: rotate(45deg);
        }
        @keyframes sparkle {
            0% {
                transform: translateX(-100%) translateY(-100%) rotate(45deg);
            }
            100% {
                transform: translateX(100%) translateY(100%) rotate(45deg);
            }
        }
        .fade-in-up {
            animation: fadeInUp 1s ease-out;
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .rotate-animation {
            animation: rotate 8s linear infinite;
        }
        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body class="overflow-x-hidden">
    <canvas id="background-canvas"></canvas>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-16 sm:py-24 text-center relative z-10">

        <header class="mb-16 sm:mb-24 scroll-animate">
            <h1 class="text-5xl md:text-7xl font-bold text-orange-600 pulse-animation sparkle">Happy Dashain!</h1>
            <p class="mt-4 text-lg md:text-xl text-amber-800 fade-in-up">A festive greeting from Umesh</p>
        </header>

        <section id="greeting-intro" class="max-w-3xl mx-auto mb-16 sm:mb-20 scroll-animate">
            <h2 class="text-3xl md:text-4xl font-bold text-red-800 mb-6">Wishing You Abundance & Joy</h2>
            <p class="text-base md:text-lg leading-relaxed text-amber-900">
                Wishing you and your loved ones a very happy and prosperous Dashain! May this auspicious festival fill your life with joy, peace, and good fortune.
            </p>
        </section>

        <section id="blessings" class="max-w-3xl mx-auto mb-16 sm:mb-20 scroll-animate">
            <div class="text-5xl md:text-6xl text-orange-500 mb-4 icon-shadow rotate-animation">üïâ</div>
            <h2 class="text-3xl md:text-4xl font-bold text-red-800 mb-6 bounce-animation">Divine Blessings</h2>
            <p class="text-base md:text-lg leading-relaxed text-amber-900">
                May the blessings of Goddess Durga guide you and protect you from all evil.
            </p>
        </section>

        <section id="celebration" class="max-w-3xl mx-auto mb-16 sm:mb-20 scroll-animate">
             <div class="flex justify-center space-x-8 text-5xl md:text-6xl mb-6 text-orange-500">
                <span class="icon-shadow floating-animation" title="Delicious Food" style="animation-delay: 0s;">üçõ</span>
                <span class="icon-shadow floating-animation" title="Flying Kites" style="animation-delay: 1s;">ü™Å</span>
                <span class="icon-shadow floating-animation" title="Family Gatherings" style="animation-delay: 2s;">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>
            </div>
            <h2 class="text-3xl md:text-4xl font-bold text-red-800 mb-6 pulse-animation">Moments of Togetherness</h2>
            <p class="text-base md:text-lg leading-relaxed text-amber-900">
                Enjoy the delicious food, the flying kites, the family gatherings, and the precious moments of togetherness.
            </p>
        </section>

        <section id="tradition" class="max-w-3xl mx-auto mb-16 sm:mb-20 scroll-animate">
             <div class="flex justify-center items-center space-x-4 mb-4">
                <div class="w-8 h-4 bg-red-600 rounded-full pulse-animation"></div>
                <div class="text-xl text-green-700 font-bold bounce-animation">Jamara</div>
            </div>
            <h2 class="text-3xl md:text-4xl font-bold text-red-800 mb-6 glow-effect">Health, Wealth & Happiness</h2>
            <p class="text-base md:text-lg leading-relaxed text-amber-900">
               May the red tika and green jamara bring you health, wealth, and happiness.
            </p>
        </section>

        <section id="gemini-features" class="max-w-3xl mx-auto mt-16 sm:mt-20 scroll-animate">
            <h2 class="text-3xl md:text-4xl font-bold text-red-800 mb-6">Make it Your Own</h2>
            <div class="bg-white/50 backdrop-blur-sm p-6 rounded-lg shadow-lg border border-orange-200">
                <div class="mb-6">
                    <label for="recipientName" class="block text-amber-900 text-left font-semibold mb-2">Recipient's Name:</label>
                    <input type="text" id="recipientName" placeholder="e.g., Sita, Ram, Family" class="w-full p-2 rounded border border-orange-300 focus:ring-orange-500 focus:border-orange-500 text-amber-900 bg-white/70">
                    <button id="generateGreetingBtn" class="mt-4 w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded transition duration-300 flex items-center justify-center disabled:opacity-50 pulse-animation hover:scale-105 transform">
                        ‚ú® Generate Personalized Greeting
                    </button>
                </div>
                <div>
                     <button id="explainStoryBtn" class="w-full bg-red-800 hover:bg-red-900 text-white font-bold py-2 px-4 rounded transition duration-300 flex items-center justify-center disabled:opacity-50 bounce-animation hover:scale-105 transform">
                        ‚ú® Tell Me the Story of Dashain
                    </button>
                </div>
                <div id="gemini-output" class="mt-6 p-4 bg-orange-50 rounded-lg border border-orange-200 text-left text-amber-900 min-h-[100px] whitespace-pre-wrap" style="display: none;">
                </div>
            </div>
        </section>

        <footer class="mt-12 scroll-animate">
            <p class="text-xl md:text-2xl font-semibold text-amber-800">Warmly,</p>
            <p class="text-2xl md:text-3xl font-bold text-orange-600 mt-2">Umesh</p>
        </footer>

    </main>

    <script>
        const canvas = document.getElementById('background-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height - canvas.height;
                this.size = Math.random() * 3 + 1;
                this.speedX = Math.random() * 2 - 1;
                this.speedY = Math.random() * 2 + 0.5;
                this.opacity = Math.random() * 0.8 + 0.2;
                this.angle = Math.random() * Math.PI * 2;
                this.angleSpeed = Math.random() * 0.02 + 0.01;
                
                // Different particle types for more variety
                const particleTypes = [
                    { color: 'rgba(234, 88, 12, opacity)', shape: 'circle' },
                    { color: 'rgba(239, 68, 68, opacity)', shape: 'circle' },
                    { color: 'rgba(245, 158, 11, opacity)', shape: 'square' },
                    { color: 'rgba(34, 197, 94, opacity)', shape: 'triangle' }
                ];
                
                this.type = particleTypes[Math.floor(Math.random() * particleTypes.length)];
                this.color = this.type.color.replace('opacity', this.opacity);
            }
            
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.angle += this.angleSpeed;
                
                // Add some wave motion
                this.x += Math.sin(this.angle) * 0.5;
                
                if (this.y > canvas.height) {
                    this.y = -this.size;
                    this.x = Math.random() * canvas.width;
                }
                
                if (this.x > canvas.width) {
                    this.x = 0;
                } else if (this.x < 0) {
                    this.x = canvas.width;
                }
            }
            
            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.angle);
                ctx.fillStyle = this.color;
                
                switch(this.type.shape) {
                    case 'circle':
                        ctx.beginPath();
                        ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                        ctx.fill();
                        break;
                    case 'square':
                        ctx.fillRect(-this.size/2, -this.size/2, this.size, this.size);
                        break;
                    case 'triangle':
                        ctx.beginPath();
                        ctx.moveTo(0, -this.size);
                        ctx.lineTo(-this.size, this.size);
                        ctx.lineTo(this.size, this.size);
                        ctx.closePath();
                        ctx.fill();
                        break;
                }
                
                ctx.restore();
            }
        }

        function initParticles() {
            particles = [];
            for (let i = 0; i < 80; i++) {
                particles.push(new Particle());
            }
        }

        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => {
                p.update();
                p.draw();
            });
            requestAnimationFrame(animateParticles);
        }

        window.addEventListener('resize', () => {
            resizeCanvas();
            initParticles();
        });

        resizeCanvas();
        initParticles();
        animateParticles();

        const animatedElements = document.querySelectorAll('.scroll-animate');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, {
            threshold: 0.1
        });

        animatedElements.forEach(el => {
            observer.observe(el);
        });

        const generateGreetingBtn = document.getElementById('generateGreetingBtn');
        const explainStoryBtn = document.getElementById('explainStoryBtn');
        const recipientNameInput = document.getElementById('recipientName');
        const geminiOutput = document.getElementById('gemini-output');

        const apiKey = ""; // Note: Add your Gemini API key here for the interactive features to work 

        async function callGemini(prompt, button) {
            const originalText = button.innerHTML;
            button.disabled = true;
            button.innerHTML = `<span class="loader"></span>Generating...`;
            geminiOutput.style.display = 'block';
            geminiOutput.textContent = 'Thinking...';

            const model = 'gemini-2.5-flash-preview-05-20';
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
            };

            let success = false;
            let retries = 3;
            let delay = 1000;

            while(retries > 0 && !success) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();
                    const candidate = result.candidates?.[0];

                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        geminiOutput.textContent = candidate.content.parts[0].text;
                    } else {
                        geminiOutput.textContent = 'Sorry, I couldn\'t generate a response. Please try again.';
                    }
                    success = true;

                } catch (error) {
                    console.error("Error calling Gemini API:", error);
                    retries--;
                    if (retries > 0) {
                        await new Promise(res => setTimeout(res, delay));
                        delay *= 2; 
                    } else {
                        geminiOutput.textContent = 'There was an issue connecting to the service. Please check your connection and try again later.';
                    }
                }
            }

            button.disabled = false;
            button.innerHTML = originalText;
        }

        generateGreetingBtn.addEventListener('click', () => {
            const recipientName = recipientNameInput.value.trim() || 'my dear friend';
            const prompt = `Write a short, warm, and festive Dashain greeting message from Umesh to ${recipientName}. Keep it to one creative and heartfelt paragraph.`;
            callGemini(prompt, generateGreetingBtn);
        });

        explainStoryBtn.addEventListener('click', () => {
            const prompt = `Explain the main story and significance of the Dashain festival in a simple, engaging paragraph suitable for a greeting card. Mention Goddess Durga and Mahishasur.`;
            callGemini(prompt, explainStoryBtn);
        });

        // Add fireworks effect when clicking on the main title
        const mainTitle = document.querySelector('h1');
        mainTitle.addEventListener('click', createFireworks);

        function createFireworks() {
            const fireworksContainer = document.createElement('div');
            fireworksContainer.style.position = 'fixed';
            fireworksContainer.style.top = '0';
            fireworksContainer.style.left = '0';
            fireworksContainer.style.width = '100%';
            fireworksContainer.style.height = '100%';
            fireworksContainer.style.pointerEvents = 'none';
            fireworksContainer.style.zIndex = '1000';
            document.body.appendChild(fireworksContainer);

            for (let i = 0; i < 6; i++) {
                setTimeout(() => {
                    const firework = document.createElement('div');
                    firework.style.position = 'absolute';
                    firework.style.left = Math.random() * 100 + '%';
                    firework.style.top = Math.random() * 50 + 20 + '%';
                    firework.style.width = '4px';
                    firework.style.height = '4px';
                    firework.style.borderRadius = '50%';
                    firework.style.backgroundColor = ['#EA5812', '#EF4444', '#F59E0B', '#22C55E'][Math.floor(Math.random() * 4)];
                    firework.style.boxShadow = `0 0 20px ${firework.style.backgroundColor}`;
                    firework.style.animation = 'fireworkBurst 1s ease-out forwards';
                    fireworksContainer.appendChild(firework);

                    // Create sparkles around the firework
                    for (let j = 0; j < 8; j++) {
                        const sparkle = document.createElement('div');
                        sparkle.style.position = 'absolute';
                        sparkle.style.left = firework.style.left;
                        sparkle.style.top = firework.style.top;
                        sparkle.style.width = '2px';
                        sparkle.style.height = '2px';
                        sparkle.style.backgroundColor = firework.style.backgroundColor;
                        sparkle.style.borderRadius = '50%';
                        sparkle.style.transform = `rotate(${j * 45}deg)`;
                        sparkle.style.animation = `sparkleOut 1s ease-out forwards`;
                        sparkle.style.animationDelay = '0.2s';
                        fireworksContainer.appendChild(sparkle);
                    }
                }, i * 200);
            }

            setTimeout(() => {
                document.body.removeChild(fireworksContainer);
            }, 2000);
        }

        // Add CSS for firework animations
        const fireworkStyles = document.createElement('style');
        fireworkStyles.textContent = `
            @keyframes fireworkBurst {
                0% {
                    transform: scale(0);
                    opacity: 1;
                }
                50% {
                    transform: scale(3);
                    opacity: 0.8;
                }
                100% {
                    transform: scale(0);
                    opacity: 0;
                }
            }
            @keyframes sparkleOut {
                0% {
                    transform: translateX(0) translateY(0) scale(0);
                    opacity: 1;
                }
                100% {
                    transform: translateX(30px) translateY(30px) scale(0.5);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(fireworkStyles);
    </script>
</body>
</html>